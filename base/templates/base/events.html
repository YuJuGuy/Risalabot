{% extends 'main.html' %}

{% block content %}
<div class="content-body">
    <h2>My Events</h2>

    {% if events %}
        <ul>
        {% for event in events %}
            <li>
                {{ event.event_type.label }}{% if event.subcategory %} - {{ event.get_subcategory_display }}{% endif %}: {{ event.message_template }}
                <button class="edit-button" data-event-id="{{ event.id }}" data-event-type-id="{{ event.event_type.id }}" data-subcategory="{{ event.subcategory }}" data-message-template="{{ event.message_template|escapejs }}">Edit</button> | 
                <a href="{% url 'delete_event' event.id %}" onclick="return confirm('Are you sure you want to delete this event?');">Delete</a>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>You have no events.</p>
    {% endif %}

    <h2>Create New Event</h2>
    <button id="myButton">Add</button>
    <div id="myPopup" class="popup">
        <div class="popup-content">
            <form id="eventForm" method="post" action="{% url 'events' %}">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" id="saveButton">Save</button>
            </form>
            <button id="closePopup">Close</button>
        </div>
    </div>

    <script>
        var order_updated_event_type_id = '{{ order_updated_event_type_id }}';
        var eventFormActionUrl = '{% url "events" %}';
    </script>
</div>
{% endblock %}
